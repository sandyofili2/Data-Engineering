#CREATION OF EXTERNAL TABLE 

CREATE OR REPLACE EXTERNAL TABLE tranquil-door-410801.ny_taxi.external_green_taxi_folder
OPTIONS (
  format = 'PARQUET',
 uris =['gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-01.parquet','gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-02.parquet',
        'gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-03.parquet', 'gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-04.parquet',
        'gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-05.parquet','gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-06.parquet',
        'gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-07.parquet','gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-08.parquet',
        'gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-09.parquet','gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-10.parquet',
        'gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-11.parquet','gs://mage-project/gREEN_TAXI-2022/green_tripdata_2022-12.parquet']
 );
 
 #FINDING DISTINCT OF PULOCATION 

 SELECT DISTINCT PULocationID FROM `tranquil-door-410801.ny_taxi.external_green_taxi_folder` 

 #Records that have a fare_amount of 0?
SELECT count(fare_amount) FROM `tranquil-door-410801.ny_taxi.external_green_taxi_folder` 
WHERE fare_amount = 0


#Write a query to retrieve the distinct PULocationID between lpep_pickup_datetime 06/01/2022 and 06/30/2022 (inclusive)

CREATE OR REPLACE TABLE tranquil-door-410801.ny_taxi.partitioned_green_taxi
PARTITION BY 
DATE (lpep_pickup_datetime) AS
SELECT * FROM `tranquil-door-410801.ny_taxi.external_green_taxi_folder`

SELECT DISTINCT(PULocationID)
 FROM `tranquil-door-410801.ny_taxi.partitioned_green_taxi` 
WHERE  DATE(lpep_pickup_datetime) BETWEEN '2022-06-01' AND '2022-06-30';
